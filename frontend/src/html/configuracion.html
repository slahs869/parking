<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="../css/configuracion.css">
	<link rel="stylesheet" href="../css/loginindex.css">
	<title>Configuracion</title>
</head>

<body><div class="logo"></div>

	<div class="cargar">

	</div>

	

	<script>
let img=localStorage.getItem("foto")
	let logo=`
		<img src="${img}" class="logoempresa" id="logo">
	`

	const logotipe=document.querySelector('.logo');
	
	logotipe.innerHTML=logo




	//let datosLeer= await leerPrice();
	//let img = datosLeer.body[1].carro;
		let html=` <div class="div_menu" id="div_menu">
		<ul id="ul_menu">
			<dt><a href="operaciones.html" id="item_menu">Inicio</a></dt>
			<dt><a href="informes.html" id="item_menu">Informes</a></dt>
			<dt><a href="mensualidades.html" id="item_menu">Mensualidades</a></dt>
			<dt><a href="configuracion.html" id="item_menu">Configuracion</a></dt>
			<dt><a href="https://wa.link/1qgsou" id="item_menu">Soporte Tecnico</a></dt>
		</ul>
	</div>

	<div class="div_titulo" id="div_titulo">
		CONFIGURACION
	</div>
	
	
	

	<div class="div_menu_confi" id="div_menu_confi">
		<nav>

			<ul id="ul_menu_confi">
				<dt id="item_menu"><a href="#" class="link_tarifa" id="link_configuracion">Tarifas</a></dt>
				<dt id="item_menu"><a href="#" class="link_usuarios" id="link_configuracion1">Usuarios</a></dt>
				<dt id="item_menu"><a href="#" class="link_impresoras" id="link_configuracion2">Impresoras</a></dt>
				<dt id="item_menu"><a href="#" class="link_factura" id="link_configuracion3">Factura</a></dt>				

			</ul>
		</nav>
	</div>
	<div class="container1" id="div_resumen">

		<div id="container2">
			<h1> PLAN DE TARIFAS </h1> 

		<div id="div_tarifa">
          <h2> MOTOS: </h2> 
          <h3>HORA:</h3>
		  <input type="text" class="iMoto">
          <h3>DIA:</h3>
		  <input type="text" class="iMoto_dia"> 
		  <h3>MES:</h3>
		  <input type="text" class="iMoto_mes">
		  <button id="boton_guardar" class="guardar_Moto ">Guardar</button>
          
          
          

		  </div>
		  <div id="div_tarifa">
			<h2>CARROS: </h2>
			
          <h3> HORA:</h3> 
		  <input type="text" class="iCarro"> 
		  <h3>DIA:</h3>        
          <input type="text" class="iCarro_dia">
		
          
          <h3>MES: </h3>
		  <input type="text" class="iCarro_mes">
		  <button id="boton_guardar" class="guardar_carro ">Guardar</button>
          
          
      <div class="iCarro">
		</div>
		</div> 
		<div class="containertarifas" id="containertarifas">
    </div> 
    <div class="containertarifas_mes" id="containertarifas_mes">
    </div> 	  
	</div>
`
const cargar=document.querySelector(".cargar")

try{
	let datos=window.localStorage.getItem("activo")
	
	const div=document.createElement("DIV")
	if(datos == 'activo'){
		div.innerHTML=html
		cargar.appendChild(div)
	}else{
		cargar.innerHTML=`  <div id="div_principal">
    <div id="div_logo">
        <img  src="../img/logo.png" class="logoempresa"  id="logoE">    
    </div>


    <div class="container_login" id="div_contenedor">

        <h1 id="label_titulo">No estas autorizado</h1>

        
    
    </div>

 
</div>`
	}
} catch(e){
	console.log('')
}


async function formularioTarifas() {
	botonMoto = document.querySelector('.guardar_Moto');
	botonCarro = document.querySelector('.guardar_carro')

	botonMoto.addEventListener("click", moto)
      botonCarro.addEventListener("click", carro)
      let MostarPrecio = await leerPrecio()
      let tarifas = document.querySelector('.containertarifas')
      tarifas.innerHTML = `<h3>TARIFAS MOTO:</h3>
     <h4>HORA MOTO: ${MostarPrecio.body[0].carro}</h4>
     <h4>DIA MOTO: ${MostarPrecio.body[0].moto}</h4>
     <h4>MES MOTO: ${MostarPrecio.body[0].moto}</h4>`


      async function carro() {
            if (inputCarro.value != '' && !isNaN(inputCarro.value)) {
                  let datosPrecio = await leerPrecio()

                  await precio('63e183f27dda95ae0da4ebcd', {
                        carro: inputCarro.value,
                        moto: datosPrecio.body[0].moto
                  })
                  localStorage.setItem("carro", inputCarro.value)
                  formularioTarifas()
            }
      }
      async function moto() {
            if (inputMoto.value != '' && !isNaN(inputMoto.value)) {
                  let datosPrecio = await leerPrecio()
                  await precio('63e183f27dda95ae0da4ebcd', {
                        moto: inputMoto.value,
                        carro: datosPrecio.body[0].carro
                  })
                  localStorage.setItem("moto", inputMoto.value)
                  formularioTarifas()
            }
      }

      botonCarro_mes = document.querySelector('.guardar_carro')
      inputCarro_mes = document.querySelector('.iCarro_mes')
      botonMoto_mes = document.querySelector('.guardar_Moto')
      inputMoto_mes = document.querySelector('.iMoto_mes')

      botonMoto_mes.addEventListener("click", moto_mes)
      botonCarro_mes.addEventListener("click", carro_mes)
      let MostarPrecio_mes = await leerPrecio()
      let tarifas_mes = document.querySelector('.containertarifas_mes')
      tarifas_mes.innerHTML = `<h3>TARIFAS CARRO:</h3>
     <h4>HORA CARRO: ${MostarPrecio_mes.body[2].carro}</h4>
     <h4>DIA CARRO: ${MostarPrecio_mes.body[2].moto}</h4>
     <h4>MES CARRO: ${MostarPrecio_mes.body[2].moto}</h4>`
      async function carro_mes() {
            if (inputCarro_mes.value != '' && !isNaN(inputCarro_mes.value)) {
                  let datosPrecio_mes = await leerPrecio()

                  await precio('63eb5ea5197365e272f55725', {
                        carro: inputCarro_mes.value,
                        moto: datosPrecio_mes.body[2].moto
                  })
                  localStorage.setItem("carro", inputCarro_mes.value)
                  formularioTarifas()
            }
      }
      async function moto_mes() {
            if (inputMoto_mes.value != '' && !isNaN(inputMoto_mes.value)) {
                  let datosPrecio_mes = await leerPrecio()
                  await precio('63eb5ea5197365e272f55725', {
                        moto: inputMoto_mes.value,
                        carro: datosPrecio_mes.body[2].carro
                  })
                  localStorage.setItem("moto", inputMoto_mes.value)
                  formularioTarifas()
            }
      }
	  
	}
	formularioTarifas();

	async function leerPrecio() {
		const url2 = 'http://localhost:3000/price';
      const response = await fetch(url2, {
            method: 'GET'
      });
      const data = await response.json();

      return data
}

	</script>
	


	<script src="../js/configuracion.js"></script>

	<!--IMPRIMIR-->
	<script language="Javascript">
		function imprSelec(nombre) {
			var ficha = document.getElementById(nombre);
			var ventimp = window.open(' ', 'popimpr');
			ventimp.document.write(ficha.innerHTML);
			ventimp.document.close();
			ventimp.print();
			ventimp.close();
		}
	</script>
	<!--END IMPRIMIR-->

</body>

</html>